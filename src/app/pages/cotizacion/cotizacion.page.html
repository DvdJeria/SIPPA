<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Cotizador</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="ngOnInit()">
        <ion-icon slot="icon-only" name="refresh-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding-bottom">

  <ion-list lines="full">
    <ion-list-header>
      <ion-label>Ingredientes</ion-label>
    </ion-list-header>

    <ion-item *ngFor="let ing of ingredients">
      <ion-label class="ion-text-wrap">
        <h2>{{ ing.ing_nombre }}</h2>
        <p>${{ ing.ing_precio }} / unidad</p>
      </ion-label>

      <!-- Stepper-like input for better mobile UX -->
      <!-- Stepper-like input for better mobile UX -->
      <ion-buttons slot="end" *ngIf="ing.ing_id">
        <ion-button fill="outline" size="small" (click)="decrementQuantity(ing.ing_id!)">
          <ion-icon slot="icon-only" name="remove-outline"></ion-icon>
        </ion-button>
        <ion-input type="number" min="0" [(ngModel)]="ingredientQuantities[ing.ing_id!]" class="qty-input">
        </ion-input>
        <ion-button fill="outline" size="small" (click)="incrementQuantity(ing.ing_id!)">
          <ion-icon slot="icon-only" name="add-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item>
  </ion-list>

  <!-- Spacer for footer -->
  <div style="height: 150px;"></div>

</ion-content>

<ion-footer class="ion-no-border">
  <ion-toolbar>
    <ion-grid>
      <ion-row>
        <ion-col size="12">
          <ion-label>Margen de Ganancia</ion-label>
          <div class="margin-presets">
            <ion-chip [color]="margin === 20 ? 'primary' : 'medium'" (click)="margin = 20">20%</ion-chip>
            <ion-chip [color]="margin === 30 ? 'primary' : 'medium'" (click)="margin = 30">30%</ion-chip>
            <ion-chip [color]="margin === 50 ? 'primary' : 'medium'" (click)="margin = 50">50%</ion-chip>
          </div>
          <ion-item lines="none" class="margin-input-item">
            <ion-range min="0" max="100" pin="true" [(ngModel)]="margin" color="secondary">
              <ion-icon size="small" slot="start" name="trending-down-outline"></ion-icon>
              <ion-icon size="small" slot="end" name="trending-up-outline"></ion-icon>
            </ion-range>
            <ion-input type="number" [(ngModel)]="margin" class="qty-input"></ion-input>
            <ion-note>%</ion-note>
          </ion-item>
        </ion-col>
        <ion-col size="12" class="ion-text-center ion-padding-vertical">
          <ion-label>
            <p>Total Sugerido</p>
            <h1 color="primary" style="font-size: 2.5em; font-weight: bold;">${{ suggestedPrice | number:'1.0-0' }}</h1>
          </ion-label>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col size="6">
          <ion-button expand="block" size="large" color="secondary" (click)="guardarCotizacion()"
            [disabled]="totalCost === 0">
            Guardar
          </ion-button>
        </ion-col>
        <ion-col size="6">
          <ion-button expand="block" size="large" color="success" (click)="convertToPedido()"
            [disabled]="totalCost === 0">
            Convertir
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-footer>